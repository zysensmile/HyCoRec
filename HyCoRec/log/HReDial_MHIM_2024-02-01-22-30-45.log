2024-02-01 22:30:45.323 | INFO     | crslab.config.config:__init__:86 - [Dataset: HReDial tokenized in nltk]
2024-02-01 22:30:45.324 | INFO     | crslab.config.config:__init__:88 - [Model: MHIM]
2024-02-01 22:30:45.325 | INFO     | crslab.config.config:__init__:95 - [Config]
{
    "dataset": "HReDial",
    "tokenize": "nltk",
    "related_truncate": 1024,
    "context_truncate": 256,
    "response_truncate": 30,
    "scale": 1,
    "model": "MHIM",
    "token_emb_dim": 300,
    "kg_emb_dim": 128,
    "num_bases": 8,
    "n_heads": 2,
    "n_layers": 2,
    "ffn_size": 300,
    "dropout": 0.1,
    "attention_dropout": 0.0,
    "relu_dropout": 0.1,
    "learn_positional_embeddings": false,
    "embeddings_scale": true,
    "reduction": false,
    "n_positions": 1024,
    "user_proj_dim": 512,
    "mha_n_heads": 4,
    "pooling": "Mean",
    "extension_strategy": "Adaptive",
    "rec": {
        "epoch": 10,
        "batch_size": 256,
        "early_stop": true,
        "stop_mode": "min",
        "impatience": 2,
        "optimizer": {
            "name": "Adam",
            "lr": 0.001
        }
    },
    "conv": {
        "epoch": 0,
        "batch_size": 128,
        "impatience": 1,
        "optimizer": {
            "name": "Adam",
            "lr": 0.001
        },
        "lr_scheduler": {
            "name": "ReduceLROnPlateau",
            "patience": 3,
            "factor": 0.5
        },
        "gradient_clip": 0.1
    },
    "pretrain": true,
    "pretrain_epoch": 10,
    "gpu": [
        0
    ],
    "model_name": "MHIM"
}
2024-02-01 22:31:44.637 | INFO     | crslab.data.dataset.base:__init__:49 - [Finish data load]
2024-02-01 22:48:03.429 | INFO     | crslab.data.dataset.base:__init__:55 - [Finish data preprocess]
2024-02-01 22:48:05.922 | INFO     | crslab.model.crs.mhim.mhim:build_model:129 - [Load Pretrain Weights from pretrain/HReDial/10-epoch.pth]
2024-02-01 22:48:06.483 | INFO     | crslab.model.crs.mhim.mhim:_build_adjacent_matrix:171 - [Adjacent Matrix built.]
2024-02-01 22:48:08.623 | INFO     | crslab.model:get_model:27 - [Build model MHIM]
2024-02-01 22:48:08.659 | INFO     | crslab.evaluator:get_evaluator:25 - [Build evaluator standard]
2024-02-01 22:48:08.660 | INFO     | crslab.system:get_system:32 - [Build system MHIM]
2024-02-01 22:48:08.661 | INFO     | crslab.system.base:build_optimizer:138 - [Build optimizer: Adam]
2024-02-01 22:48:08.661 | INFO     | crslab.system.mhim:train_recommender:112 - [Recommendation epoch 0]
2024-02-01 22:48:08.661 | INFO     | crslab.system.mhim:train_recommender:113 - [Train]
2024-02-01 23:05:07.533 | INFO     | crslab.evaluator.standard:report:65 - 
{"grad norm": 7.83, "rec_loss": 7.503}
2024-02-01 23:05:07.534 | INFO     | crslab.system.mhim:train_recommender:118 - [Valid]
2024-02-01 23:05:55.062 | INFO     | crslab.evaluator.standard:report:65 - 
{"cov@10": 958, "cov@15": 1102, "cov@20": 1228, "cov@5": 760, "mrr@1": 0.0299, "mrr@10": 0.06872, "mrr@50": 0.07732, "ndcg@1": 0.0299, "ndcg@10": 0.09596, "ndcg@50": 0.1359, "rec_loss": 7.266, "recall@1": 0.0299, "recall@10": 0.1858, "recall@50": 0.3657}
2024-02-01 23:05:55.062 | INFO     | crslab.system.base:early_stop:249 - [Get new best model]
2024-02-01 23:05:55.063 | INFO     | crslab.system.mhim:train_recommender:112 - [Recommendation epoch 1]
2024-02-01 23:05:55.063 | INFO     | crslab.system.mhim:train_recommender:113 - [Train]
2024-02-01 23:23:16.132 | INFO     | crslab.evaluator.standard:report:65 - 
{"grad norm": 6.278, "rec_loss": 6.315}
2024-02-01 23:23:16.133 | INFO     | crslab.system.mhim:train_recommender:118 - [Valid]
2024-02-01 23:24:04.795 | INFO     | crslab.evaluator.standard:report:65 - 
{"cov@10": 1280, "cov@15": 1475, "cov@20": 1640, "cov@5": 997, "mrr@1": 0.03367, "mrr@10": 0.07721, "mrr@50": 0.08688, "ndcg@1": 0.03367, "ndcg@10": 0.1069, "ndcg@50": 0.1522, "rec_loss": 7.084, "recall@1": 0.03367, "recall@10": 0.2046, "recall@50": 0.4099}
2024-02-01 23:24:04.795 | INFO     | crslab.system.base:early_stop:249 - [Get new best model]
2024-02-01 23:24:04.796 | INFO     | crslab.system.mhim:train_recommender:112 - [Recommendation epoch 2]
2024-02-01 23:24:04.796 | INFO     | crslab.system.mhim:train_recommender:113 - [Train]
2024-02-01 23:41:25.670 | INFO     | crslab.evaluator.standard:report:65 - 
{"grad norm": 6.2, "rec_loss": 5.852}
2024-02-01 23:41:25.671 | INFO     | crslab.system.mhim:train_recommender:118 - [Valid]
2024-02-01 23:42:12.938 | INFO     | crslab.evaluator.standard:report:65 - 
{"cov@10": 1561, "cov@15": 1837, "cov@20": 2056, "cov@5": 1200, "mrr@1": 0.03425, "mrr@10": 0.07766, "mrr@50": 0.08779, "ndcg@1": 0.03425, "ndcg@10": 0.1094, "ndcg@50": 0.1563, "rec_loss": 7.073, "recall@1": 0.03425, "recall@10": 0.2145, "recall@50": 0.4258}
2024-02-01 23:42:12.938 | INFO     | crslab.system.base:early_stop:249 - [Get new best model]
2024-02-01 23:42:12.939 | INFO     | crslab.system.mhim:train_recommender:112 - [Recommendation epoch 3]
2024-02-01 23:42:12.939 | INFO     | crslab.system.mhim:train_recommender:113 - [Train]
2024-02-01 23:59:32.324 | INFO     | crslab.evaluator.standard:report:65 - 
{"grad norm": 6.179, "rec_loss": 5.513}
2024-02-01 23:59:32.325 | INFO     | crslab.system.mhim:train_recommender:118 - [Valid]
2024-02-02 00:00:23.945 | INFO     | crslab.evaluator.standard:report:65 - 
{"cov@10": 1721, "cov@15": 2024, "cov@20": 2285, "cov@5": 1304, "mrr@1": 0.03454, "mrr@10": 0.0797, "mrr@50": 0.08981, "ndcg@1": 0.03454, "ndcg@10": 0.1123, "ndcg@50": 0.1591, "rec_loss": 7.118, "recall@1": 0.03454, "recall@10": 0.22, "recall@50": 0.4313}
2024-02-02 00:00:23.947 | INFO     | crslab.system.mhim:train_recommender:112 - [Recommendation epoch 4]
2024-02-02 00:00:23.947 | INFO     | crslab.system.mhim:train_recommender:113 - [Train]
2024-02-02 00:17:42.265 | INFO     | crslab.evaluator.standard:report:65 - 
{"grad norm": 6.241, "rec_loss": 5.259}
2024-02-02 00:17:42.266 | INFO     | crslab.system.mhim:train_recommender:118 - [Valid]
2024-02-02 00:18:28.626 | INFO     | crslab.evaluator.standard:report:65 - 
{"cov@10": 1923, "cov@15": 2271, "cov@20": 2537, "cov@5": 1426, "mrr@1": 0.03396, "mrr@10": 0.07892, "mrr@50": 0.08937, "ndcg@1": 0.03396, "ndcg@10": 0.1102, "ndcg@50": 0.1591, "rec_loss": 7.218, "recall@1": 0.03396, "recall@10": 0.2131, "recall@50": 0.4351}
2024-02-02 00:18:28.627 | INFO     | crslab.system.base:early_stop:254 - [Early stop]
2024-02-02 00:18:28.627 | INFO     | crslab.system.mhim:train_recommender:129 - [Test]
2024-02-02 00:19:27.563 | INFO     | crslab.evaluator.standard:report:65 - 
{"cov@10": 1932, "cov@15": 2261, "cov@20": 2515, "cov@5": 1429, "mrr@1": 0.03196, "mrr@10": 0.0734, "mrr@50": 0.08261, "ndcg@1": 0.03196, "ndcg@10": 0.1023, "ndcg@50": 0.1442, "rec_loss": 7.276, "recall@1": 0.03196, "recall@10": 0.1976, "recall@50": 0.3852}
2024-02-02 00:19:27.565 | INFO     | crslab.system.base:build_optimizer:138 - [Build optimizer: Adam]
2024-02-02 00:19:27.565 | INFO     | crslab.system.base:build_lr_scheduler:155 - [Build scheduler ReduceLROnPlateau]
2024-02-02 00:19:27.566 | INFO     | crslab.system.mhim:train_conversation:162 - [Test]
2024-02-02 00:22:25.765 | INFO     | crslab.evaluator.standard:report:65 - 
{"bleu@1": 0.03228, "bleu@2": 9.407e-06, "bleu@3": 2.225e-308, "bleu@4": 2.225e-308, "dist@1": 0.08452, "dist@2": 0.2651, "dist@3": 0.3863, "dist@4": 0.4989, "f1": 0.04818}
